unit Unit6;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, sButton, Vcl.Imaging.jpeg,
  Vcl.ExtCtrls, sEdit, sLabel;

type
  TNew_Contact = class(TForm)
    Image1: TImage;
    Add_newContact: TsButton;
    Edit_Contact: TsButton;
    Delete_Contact: TsButton;
    Name_Contacts_label: TsLabel;
    Name_Contact: TsEdit;
    Number_Phone: TsEdit;
    Number_Phone_Label: TsLabel;
    Exit: TsButton;
    procedure Add_newContactClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure ExitClick(Sender: TObject);
    procedure Edit_ContactClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

type
Contact = record
  Contact_Name:string;
  Contact_Number:string;
end;

var
  New_Contact: TNew_Contact;
  MyContacts: array of Contact;
  Contacts_File: TextFile;

implementation

{$R *.dfm}

uses Unit4, Unit2, Unit7;

procedure TNew_Contact.Add_newContactClick(Sender: TObject);
begin
  Setlength(MyContacts, length(MyContacts)+1);
  MyContacts[length(MyContacts)-1].Contact_Name := Name_Contact.Text;
  MyContacts[length(MyContacts)-1].Contact_Number := Number_Phone.Text;
end;

procedure TNew_Contact.Edit_ContactClick(Sender: TObject);
var
  i: Integer;
begin
  Redact_Items.Items_Name.Caption := 'Все контакты';
  Redact_Items.All_Items.Cells[0,0] := 'Имя';
  Redact_Items.All_Items.Cells[1,0] := 'Номер';
  Redact_Items.All_Items.RowCount := length(MyContacts)+1;
  for i := 0 to length(MyContacts) do
  begin
    Redact_Items.All_Items.Cells[0 ,i+1] := MyContacts[i].Contact_Name;
    Redact_Items.All_Items.Cells[1, i+1] := MyContacts[i].Contact_Number;
  end;

  Redact_Items.Showmodal;

end;

procedure TNew_Contact.ExitClick(Sender: TObject);
var
i:integer;
begin
  Rewrite(Contacts_File);
  for i := 0  to length(MyContacts)-1 do
  begin
    Writeln(Contacts_File, MyContacts[i].Contact_Name);
    Writeln(Contacts_File, MyContacts[i].Contact_Number);
    Writeln(Contacts_File);
  end;
  CloseFile(Contacts_File);
  New_Contact.Close;
  Organizer.Show;
end;

procedure TNew_Contact.FormCreate(Sender: TObject);
begin
  AssignFile(Contacts_File,'d:\ДОКУМЕНТЫ\Новая папка\Files\Contacts.txt');
  Reset(Contacts_File);
  while not (EOF(Contacts_File)) do
  begin
    Setlength(MyContacts, length(MyContacts)+1);
    readln(Contacts_File, MyContacts[length(MyContacts)-1].Contact_Name);
    readln(Contacts_File, MyContacts[length(MyContacts)-1].Contact_Number);
    readln(Contacts_File);
  end;
  CloseFile(Contacts_File);
  showmessage(MyContacts[0].Contact_Name );
  showmessage(MyContacts[0].Contact_Number );
  Showmessage(MyContacts[1].Contact_Name );
  showmessage(MyContacts[1].Contact_Number );
end;

end.
